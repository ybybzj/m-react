!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("m-react",e):t.mReact=e()}(this,function(){"use strict";function t(){}function e(t){if(null===t)return"null";if(void 0===t)return"undefined";if(t!==t)return"NaN";var e=Object.prototype.toString.call(t).match(dt);return null==e?"unknown":e[1].toLowerCase()}function n(){return pt.apply(arguments[0],pt.call(arguments,1))}function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function o(){for(var t,e,n,o=arguments.length,i=0;o>i&&(n=arguments[i],n!==Object(n));)i++;if(i===o)return{};for(i++;o>i;)if(e=arguments[i++],e===Object(e))for(t in e)r(e,t)&&(n[t]=e[t]);return n}function i(){var t=n(arguments);return o.apply(null,[{}].concat(t))}function s(t){if("object"!==e(t))throw new TypeError("[removeVoidValue]param should be a object! given: "+t);var n={};return Object.keys(t).forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n}function a(t){for(var n=[],r=!0,o=0,i=t.length;i>o;o++){var s=t[o];if("array"!==e(s)){r=!1;break}n.push(s)}return n=r===!1||0===t.length?t:[].concat.apply([],n)}function l(t){switch(e(t)){case"undefined":case"null":return[];case"array":return a(t);default:return[t]}}function u(){return Object.create(null)}function c(t,n){return"string"!==e(t)||"regexp"!==e(n)?null:t.match(n)}function h(t,e){if(t===e)return e;var n=t.compareDocumentPosition(e);return 24&n?16&n?t:e:null}function f(){var t=arguments[0],r=arguments[1],o=n(arguments,2);if("string"!==e(t))throw new Error("selector in m(selector, attrs, children) should be a string");var i,s,a,l=!(null==r||"object"!==e(r)||"tag"in r||"view"in r||"subtree"in r),u={tag:"div",attrs:{}},c=[];r=l?r:{},a="class"in r?"class":"className",o=l?o:n(arguments,1),u.children="array"===e(o[0])?o[0]:o;for(;i=vt.exec(t);)""===i[1]&&i[2]?u.tag=i[2]:"#"===i[1]?u.attrs.id=i[2]:"."===i[1]?c.push(i[2]):"["===i[3][0]&&(s=gt.exec(i[3]),u.attrs[s[1]]=s[3]||(s[2]?"":!0));return c.length>0&&(u.attrs[a]=c.join(" ")),Object.keys(r).forEach(function(t){var n=r[t];u.attrs[t]=t===a&&"string"!==e(n)&&""!==n.trim()?(u.attrs[t]||"")+" "+n:n}),u}function d(n){this.options=n||{};var r=this.options.onFlush;this._cb="function"===e(r)?r:t,this._queue=[],this._startPos=0,this.flush=this.flush.bind(this)}function p(){return!this instanceof p?new p:(this._index=-1,this._keys=[],void(this._values=[]))}function v(t,e){return isNaN(t)?isNaN(e):t===e}function g(t){if(t!==Object(t))throw new TypeError("[Map]Invalid value used as a map key! given: "+t)}function m(t){if(!this instanceof m)return new m(t);if(t=t||wt||{documentElement:1},!t.documentElement)throw new Error('[DOMDelegator]Invalid parameter "doc", should be a document object! given: '+t);this.root=t.documentElement,this.listenedEvents=u(),this.eventDispatchers=u(),this.globalListeners=u(),this.domEvHandlerMap=new p}function y(t,e){var n=e.globalListeners,r=e.root;return function(o){var i=n[t]||[];if(i&&i.length>0){var s=new T(o);s.target=r,E(i,s)}w(o.target,o,t,e)}}function w(t,e,n,r){var o=b(t,n,r);if(o&&o.handlers.length>0){var i=new T(e);i.currentTarget=o.currentTarget,E(o.handlers,i),i._bubbles&&w(o.currentTarget.parentNode,e,n,r)}}function b(t,e,n){if(null==t)return null;var r,o=k(n.domEvHandlerMap,t);return o&&(r=o[e])&&0!==r.length?{currentTarget:t,handlers:r}:b(t.parentNode,e,n)}function E(t,n){t.forEach(function(r){if("function"===e(r))r(n);else{if("function"!==e(r.handleEvent))throw new Error("[DOMDelegator callListeners] unknown handler found: "+JSON.stringify(t));r.handleEvent(n)}})}function k(t,e,n){return arguments.length>2?t.get(e,n):t.get(e)}function x(t,e,n,r){var o=t[e]||[];return 0===o.length&&n.listenTo(e),-1===o.indexOf(r)&&o.push(r),t[e]=o,r}function _(t,e,n,r){var o=t[e];if(!o||0===o.length||3===arguments.length)return o&&o.length&&n.unlistenTo(e),delete t[e],r;var i=o.indexOf(r);return-1!==i&&o.splice(i,1),t[e]=o,0===o.length&&(n.unlistenTo(e),delete t[e]),r}function O(t,e){return Object.keys(t).forEach(function(n){_(t,n,e)}),t}function N(t,e,n){return t.addEventListener(e,n,!0)}function j(t,e,n){return t.removeEventListener(e,n,!0)}function T(t){return!this instanceof T?new T(t):(this.init(t),void(Ct.test(t.type)?D(this,t,"key"):At.test(t.type)&&D(this,t,"mouse")))}function D(t,e,n){for(var r=Dt[n],o=0,i=r.length;i>o;o++){var s=r[o];t[s]=e[s]}}function C(t,e){e=e||[],e=[].concat(e);for(var n=t.length-1;n>-1;n--)if(t[n]&&t[n].parentNode){e[n]&&A(e[n]),Rt.off(t[n]),Pt.remove(t[n]);try{t[n].parentNode.removeChild(t[n])}catch(r){}}0!=t.length&&(t.length=0)}function A(n){if(n.configContext&&"function"===e(n.configContext.onunload)&&(n.configContext.onunload(),n.configContext.onunload=null),n.controllers)for(var r=0,o=n.controllers.length;o>r;r++){var i=n.controllers[r];"function"===e(i.onunload)&&(i.onunload({preventDefault:t}),Et.unloaders.remove(i))}if(n.children)if("array"===e(n.children))for(var r=0,o=n.children.length;o>r;r++){var s=n.children[r];A(s)}else n.children.tag&&A(n.children)}function M(t,n,r,o,i){return Object.keys(r).forEach(function(s){var a,l=r[s],u=o[s];if(s in o&&u===l)"value"===s&&"input"===n&&t.value!=l&&(t.value=l);else{o[s]=l;try{if("config"===s||"key"==s)return;if("function"===e(l)&&0===s.indexOf("on"))t[s]=l;else if((a=c(s,Ft))&&a[1].length){var h=a[1].toLowerCase();Lt.off(t,h),P(l)&&Lt.on(t,h,l)}else"style"===s&&null!=l&&"object"===e(l)?(Object.keys(l).forEach(function(e){(null==u||u[e]!==l[e])&&(t.style[e]=l[e])}),"object"===e(u)&&Object.keys(u).forEach(function(e){e in l||(t.style[e]="")})):null!=i?"href"===s?t.setAttributeNS("http://www.w3.org/1999/xlink","href",l):"className"===s?t.setAttribute("class",l):t.setAttribute(s,l):s in t&&"list"!==s&&"style"!==s&&"form"!==s&&"type"!==s&&"width"!==s&&"height"!==s?("input"!==n||t[s]!==l)&&(t[s]=l):t.setAttribute(s,l)}catch(f){if(f.message.indexOf("Invalid argument")<0)throw f}}}),o}function P(t){return"function"===e(t)||t&&"function"===e(t.handleEvent)}function R(t,n,r,o,i,s,a,l,u,c,h){try{(null==i||null==i.toString())&&(i="")}catch(f){i=""}if("retain"===i.subtree)return s;var d,p=e(s),v=e(i);return(null==s||p!==v)&&(s=L(i,s,l,o,r,v)),"array"===v?(i=W(i),d=s.length===i.length,s=F(i,s,t),s=H(i,s,t,n,l,a,d,u,c,h)):null!=i&&"object"===v?s=q(i,s,t,l,a,u,c,h):"function"!==e(i)&&(s=B(i,s,t,n,l,a,u)),s}function L(t,e,n,r,o,i){var s,a;return null!=e&&(o&&o.nodes?(s=n-r,a=s+("array"===i?t:e.nodes).length,C(o.nodes.slice(s,a),o.slice(s,a))):e.nodes&&C(e.nodes,e)),e=new t.constructor,e.tag&&(e={}),e.nodes=[],e}function F(t,n,r){function o(t){return"string"===e(t)||"number"===e(t)&&"NaN"!==e(t)}function i(t){return t&&t.attrs&&o(t.attrs.key)?t.attrs.key:void 0}function s(t,e){t&&t.attrs&&(void 0===e?delete t.attrs.key:t.attrs.key=e)}function a(){return t.length!==n.length?!0:t.some(function(t,e){var r=n[e];return r.attrs&&t.attrs&&r.attrs.key!==t.attrs.key})}function l(t,e){var r=i(t);if(void 0!==r)if(d[r]){var o=d[r].index;d[r]={action:f,index:e,from:o,element:n.nodes[o]||wt.createElement("div")}}else d[r]={action:h,index:e}}function u(e,o){var i=e.index,s=e.action;if(s===c&&(C(n[i].nodes,n[i]),o.splice(i,1)),s===h){var a=wt.createElement("div");a.setAttribute("data-mref",i);var l=t[i].attrs.key;r.insertBefore(a,r.childNodes[i]||null),o.splice(i,0,{attrs:{key:l},nodes:[a]}),o.nodes[i]=a}s===f&&(e.element.setAttribute("data-mref",i),r.childNodes[i]!==e.element&&null!==e.element&&r.insertBefore(e.element,r.childNodes[i]||null),o[i]=n[e.from],o.nodes[i]=e.element)}var c=1,h=2,f=3,d={},p=!1;n.forEach(function(t,e){var n=i(t);s(t,n),void 0!==n&&(p=!0,d[n]={action:c,index:e})});var v=0;if(t.some(function(t){var e=i(t);return s(t,e),void 0!==e})&&t.forEach(function(t){t&&t.attrs&&null==t.attrs.key&&(t.attrs.key="__m-react__"+v++)}),p&&a()){t.forEach(l);var g=void 0,m=new Array(n.length);g=Object.keys(d).map(function(t){return d[t]}).sort(function(t,e){return t.action-e.action||t.index-e.index}),m.nodes=n.nodes.slice();for(var y=0,w=g.length;w>y;y++)u(g[y],m);n=m}return n}function H(t,n,r,o,i,s,a,l,u,c){function h(t){var h=R(r,o,n,i,t,n[d],s,i+f||f,l,u,c);void 0!==h&&(h.nodes.intact||(a=!1),f+=h.$trusted?(h.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:"array"===e(h)?h.length:1,n[d++]=h)}var f=0,d=0,p=[];if(t.forEach(h),!a){for(var v=0,g=t.length;g>v;v++)null!=n[v]&&p.push.apply(p,n[v].nodes);for(var m,v=0;m=n.nodes[v];v++)null!=m.parentNode&&p.indexOf(m)<0&&C([m],[n[v]]);t.length<n.length&&(n.length=t.length),n.nodes=p}return n}function q(n,r,o,i,s,a,l,u){for(var c,h,f=[],d=[];n.view;){var p=n.view,v=n.view.$original||p,g=r.views?r.views.indexOf(v):-1,m=g>-1?r.controllers[g]:new(n.controller||t),y=m.instance;"object"==typeof y&&(c=y.name,"object"==typeof y.cached&&(h=y.cached),y.viewFn=[p,m]);var w=n&&n.attrs&&n.attrs.key;if(n=n.view(m),"retain"===n.subtree)return h?h:r;null!=w&&(n.attrs||(n.attrs={}),n.attrs.key=w),m.onunload&&Et.unloaders.set(m,m.onunload),f.push(v),d.push(m)}if(!n.tag&&d.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");if(n.attrs||(n.attrs={}),null!=h&&(r=h),r.attrs||(r.attrs={}),(n.tag!=r.tag||!U(n.attrs,r.attrs)||n.attrs.id!=r.attrs.id||n.attrs.key!=r.attrs.key||"string"===e(c)&&r.componentName!=c)&&r.nodes.length&&C(r.nodes,r),"string"!==e(n.tag))return r;var b,E,k=0===r.nodes.length,x=Object.keys(n.attrs),_=x.length>("key"in n.attrs?1:0);if(n.attrs.xmlns?l=n.attrs.xmlns:"svg"===n.tag?l="http://www.w3.org/2000/svg":"math"===n.tag&&(l="http://www.w3.org/1998/Math/MathML"),k){var O=I(o,l,n,i);b=O[0],E=O[1],r={tag:n.tag,attrs:_?M(b,n.tag,n.attrs,{},l):n.attrs,children:null!=n.children&&n.children.length>0?R(b,n.tag,void 0,void 0,n.children,r.children,!0,0,n.attrs.contenteditable?b:a,l,u):n.children,nodes:[b]},d.length&&(r.views=f,r.controllers=d),r.children&&!r.children.nodes&&(r.children.nodes=[]),"select"===n.tag&&"value"in n.attrs&&M(b,n.tag,{value:n.attrs.value},{},l),null!=E&&o.insertBefore(b,o.childNodes[E]||null)}else b=r.nodes[0],_&&M(b,n.tag,n.attrs,r.attrs,l),r.children=R(b,n.tag,void 0,void 0,n.children,r.children,!1,0,n.attrs.contenteditable?b:a,l,u),r.nodes.intact=!0,d.length&&(r.views=f,r.controllers=d),s===!0&&null!=b&&o.insertBefore(b,o.childNodes[i]||null);if("string"===e(c)&&(r.componentName=c),"function"===e(n.attrs.config)){var N=r.configContext=r.configContext||{},j=function(t){return function(){return n.attrs.config.apply(n,t)}};u.push(j([b,!k,N,r,[o,i,a,l]]))}return r}function I(t,e,n,r){var o,i,s=r;if(t&&t.childNodes.length&&(i=S(t,r),i&&i[0])){if(s=i[1],i[0].tagName.toLowerCase()==n.tag.toLowerCase())return[i[0],null];C([i[0]])}return o=n.attrs.is?void 0===e?wt.createElement(n.tag,n.attrs.is):wt.createElementNS(e,n.tag,n.attrs.is):void 0===e?wt.createElement(n.tag):wt.createElementNS(e,n.tag),o.setAttribute("data-mref",r),[o,s]}function S(t,e){for(var n,r=0,o=t.childNodes.length;o>r;r++)if(n=t.childNodes[r],n.getAttribute&&n.getAttribute("data-mref")==e)return[n,r];return null}function B(t,e,n,r,o,i,s){var a;if(0===e.nodes.length){if(""==t)return e;C([n.childNodes[o]]),t.$trusted?a=$(n,o,t):(a=[wt.createTextNode(t)],n.nodeName.match(Ht)||n.insertBefore(a[0],n.childNodes[o]||null)),e="string number boolean".indexOf(typeof t)>-1?new t.constructor(t):t,e.nodes=a}else e.valueOf()!==t.valueOf()||i===!0?(a=e.nodes,s&&s===wt.activeElement||(t.$trusted?(C(a,e),a=$(n,o,t)):"textarea"===r?n.value=t:s?s.innerHTML=t:((1===a[0].nodeType||a.length>1)&&(C(e.nodes,e),a=[wt.createTextNode(t)]),n.insertBefore(a[0],n.childNodes[o]||null),a[0].nodeValue=t)),e=new t.constructor(t),e.nodes=a):e.nodes.intact=!0;return e}function W(t){for(var n=0;n<t.length;n++)"array"===e(t[n])&&(t=t.concat.apply([],t),n--);return t}function U(t,e){var n=Object.keys(t).sort().join(),r=Object.keys(e).sort().join();return n===r}function $(t,e,n){var r=t.childNodes[e];if(r){var o=1!==r.nodeType,i=wt.createElement("span");o?(t.insertBefore(i,r||null),i.insertAdjacentHTML("beforebegin",n),t.removeChild(i)):r.insertAdjacentHTML("beforebegin",n)}else t.insertAdjacentHTML("beforeend",n);for(var s,a=[];(s=t.childNodes[e++])!==r;)a.push(s);return a}function K(t,e,n,r){var o={root:t,vNode:e,forceRecreation:n};return r===!0?Y(o):void Et.renderQueue.addTarget({mergeType:1,root:t,processor:Y,params:[o]})}function Y(t){var e=t.root,n=t.vNode,r=t.forceRecreation;if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o,i=[],s=e===wt||e===wt.documentElement,a=s?qt:e;s&&"html"!==n.tag&&(n={tag:"html",attrs:{},children:n}),r&&Q(a),o=R(a,null,void 0,void 0,n,It.get(a),!1,0,null,void 0,i),i.forEach(function(t){t()}),It.set(a,o)}function Q(t){C(t.childNodes,It.get(t)),It.remove(t)}function X(t){Bt!==!0&&(Bt=!0,t===!0&&(Et.forcing=!0),G(t),Bt=!1)}function G(t){var n,r,o,i;(0===St.length()||t===!0)&&"function"===e(Et.computePreRedrawHook)&&(Et.computePreRedrawHook(),Et.computePreRedrawHook=null),St.length()>0&&St.stop();for(var s=0,a=Et.roots.length;a>s;s++)n=Et.roots[s],r=Et.components[s],o=Et.controllers[s],i=Et.recreations[s],o&&("object"==typeof o.instance&&(o.instance.viewFn=[r.view,o]),K(n,r.view?r.view(o):"",i,t)),Et.recreations[s]=void 0;t===!0&&(V(),Et.forcing=!1)}function V(){"function"===e(Et.computePostRedrawHook)&&(Et.computePostRedrawHook(),Et.computePostRedrawHook=null)}function Z(t){var e=t.processor,n=t.params;"function"==typeof e&&e.apply(null,n)}function z(t,e){var n,r,o,i;for(n=0,r=t.length;r>n;n++)if(i=J(t[n],e)){o=n;break}return o>-1?(t.splice(o,1),t.push(i)):t.push(e),t}function J(t,e){var n=t.root,r=e.root;if(t.mergeType&e.mergeType)return n===r?e:null;var o=h(n,r);return o?o===n?t:e:null}function tt(n,r,o){if(!n)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var i=Et.roots.indexOf(n);0>i&&(i=Et.roots.length);var s=!1,a={preventDefault:function(){s=!0,Et.computePreRedrawHook=Et.computePostRedrawHook=null}};if(Et.unloaders.each(function(t,e){t.call(e,a),e.onunload=null}),s?Et.unloaders.each(function(t,e){e.onunload=t}):Et.unloaders.clear(),Et.controllers[i]&&"function"===e(Et.controllers[i].onunload)&&Et.controllers[i].onunload(a),!s){Et.roots[i]=n;var l=Wt=r=r||{controller:t},u=r.controller||t,c=new u;return l===Wt&&(Et.controllers[i]=c,Et.components[i]=r,Et.recreations[i]=o),X(),Et.controllers[i]}}function et(e,r){var o=function(){return(e.controller||t).apply(this,r)||this};e.controller&&(o.prototype=e.controller.prototype);var i=function(t){return arguments.length>1&&(r=r.concat(n(arguments,1))),e.view.apply(e,r.length?[t].concat(r):[t])};i.$original=e.view;var s={controller:o,view:i};return r[0]&&null!=r[0].key&&(s.attrs={key:r[0].key}),s}function nt(t){return et(t,n(arguments,1))}function rt(t){var e=t.viewFn,n=e[0](e[1]),r=t.props.key,o=t.redrawData,i=o[0],s=o[1],a=o[2],l=o[3],u=[];null!=r&&(n.attrs=n.attrs||{},n.attrs.key=r),t.cached=R(i,null,void 0,void 0,n,t.cached,!1,s,a,l,u);for(var c=0,h=u.length;h>c;c++)u[c]()}function ot(t){if("object"!==e(t))throw new TypeError("[createComponent]param should be a object! given: "+t);var n={},r=st(t);return n.controller=function(t,n){var o=new r(t,n),i={instance:o};return i.onunload=o.onunload.bind(o,o.componentWillUnmount),"string"===e(o.name)&&(i.name=o.name),i},n.view=at(),n}function it(t,r){var o;for("array"!==e(r)&&(r=n(arguments,1)),r=r.filter(function(t){return"object"===e(t)});r.length>0;)o=r.shift(),Object.keys(o).forEach(function(n){if("mixins"===n)return void(r=ct([].concat(o[n]),r));if(-1===Kt.indexOf(n))return-1!==Ut.indexOf(n)?void("array"===e(t[n])?t[n].push(o[n]):t[n]="function"===e(t[n])?[t[n],o[n]]:[o[n]]):void(t[n]=o[n])});Ut.forEach(function(n){if("array"===e(t[n])){var r=t[n].filter(function(t){return"function"===e(t)});t[n]=ht(-1!==$t.indexOf(n),r)}})}function st(t){var n,r=function(){Yt.apply(this,arguments),lt(r.prototype,this)};return r.prototype=Object.create(Yt.prototype),n=t.mixins||[],delete t.mixins,n="array"===e(n)?n.concat(t):[n,t],it(r.prototype,n),r}function at(){var t={};return function(n,r,o){var i=n.instance,s=t.props,a=t.state,l=function(t,n,r,o,l){ut(i,"setInternalProps",t,o,l),n?ut(i,"componentDidUpdate",t,s,a):(ut(i,"componentDidMount",t),"function"===e(i.componentWillDetached)&&(r.onunload=i.componentWillDetached.bind(i,t)))};if(i.setProps(r,o),t.props=i.props,t.state=i.state,null!=i.root){if(ut(i,"shouldComponentUpdate",s,a)===!1)return{subtree:"retain"};ut(i,"componentWillUpdate",i.root,s,a)}else ut(i,"componentWillMount",s,a);var u=ut(i,"render",i.props,i.state);return u.attrs=u.attrs||{},u.attrs.config=l,u}}function lt(t,n){Object.keys(t).forEach(function(r){var o=t[r];("function"===e(o)||/^on[A-Z]\w*/.test(r))&&(n[r]=o.bind(n))})}function ut(t,r){var o=n(arguments,2);return"function"===e(t[r])?t[r].apply(t,o):void 0}function ct(t,e){var n,r,o=t.length;for(n=0;o>n;n++)r=t[n],-1===e.indexOf(r)&&e.unshift(r);return e}function ht(t,e){return function(){for(var r,o=n(arguments,0),i=this,s=0,a=e.length,l=o;a>s;s++)r=e[s],l=r.apply(i,o),o=t?l:o;return l}}var ft={};ft.classCallCheck=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};var dt=/^\[object (\w+)\]$/,pt=Array.prototype.slice,vt=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,gt=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/;f.trust=function(t){return t=new String(t),t.$trusted=!0,t},d.prototype.addTarget=function(t){var n=this._queue.length;return"function"===e(this.options.onAddTarget)?this._queue=this.options.onAddTarget.call(this,this._queue,t):this._queue.push(t),0===n&&1===this._queue.length&&this.scheduleFlush(),this},d.prototype.removeTarget=function(t){var e=this._queue.indexOf(t);return-1!==e&&this._queue.splice(e,1),this},d.prototype.flush=function(){var t,n,r,o,i,s=new Date,a=this._cb,l=this._startPos;for(i=this._queue,r=l,o=i.length;o>r;r++){n=i[r];try{a.call(null,n)}catch(u){console[console.error?"error":"log"](u),console.log(u.stack)}if(t=new Date-s,t>xt){r++;break}}this._queue.splice(0,r),this._startPos=0,this._queue.length?this.scheduleFlush():"function"===e(this.options.onFinish)&&this.options.onFinish.call(null)},d.prototype.scheduleFlush=function(){return this._tick&&Nt(this._tick),this._tick=Ot(this.flush),this._tick},d.prototype.onFlush=function(t){if("function"!==e(t))throw new TypeError("[Batch.prototype.onFlush]need a Function here, but given "+t);return this._cb=t,this},d.prototype.length=function(){return this._queue.length},d.prototype.stop=function(){return Nt(this._tick),this._queue.length=0,this},["onAddTarget","onFinish"].forEach(function(t){d.prototype[t]=function(n){if("function"!==e(n))throw new TypeError("[Batch.prototype."+t+"]need a Function here, but given "+n);return this.options[t]=n,this}}),p.prototype={has:function(t){g(t);var e,n=this._keys;if(t!=t||0===t)for(e=n.length;e--&&!v(n[e],t););else e=n.indexOf(t);return this._index=e,e>-1},clear:function(){this._keys.length=0,this._values.length=0,this._index=-1},set:function(t,e){return this.has(t)?this._values[this._index]=e:this._values[this._keys.push(t)-1]=e,this},get:function(t,e){return this.has(t)?this._values[this._index]:(arguments.length>1&&this.set(t,e),e)},remove:function(t){var e=this._index;return this.has(t)&&(this._keys.splice(e,1),this._values.splice(e,1)),e>-1},each:function(t){if("function"==typeof t)for(var e=0,n=this._keys.length;n>e;e++)t(this._values[e],this._keys[e])}};var mt=m.prototype;mt.on=function(t,e,n){var r=k(this.domEvHandlerMap,t,u());return x(r,e,this,n),this},mt.off=function(t,e,n){var r=k(this.domEvHandlerMap,t);return r?(arguments.length>=3?_(r,e,this,n):2===arguments.length?_(r,e,this):O(r,this),0===Object.keys(r).length&&this.domEvHandlerMap.remove(t),this):this},mt.addGlobalEventListener=function(t,e){return x(this.globalListeners,t,this,e),this},mt.removeGlobalEventListener=function(t,e){return arguments.length>=2?_(this.globalListeners,t,this,e):1===arguments.length?_(this.globalListeners,t,this):O(this.globalListeners,this),this},mt.destroy=function(){this.unlistenTo(),this.listenedEvents=null,this.eventDispatchers=null,this.globalListeners=null,this.domEvHandlerMap.clear()},mt.listenTo=function(t){if(t in this.listenedEvents||(this.listenedEvents[t]=0),this.listenedEvents[t]++,1!==this.listenedEvents[t])return this;var e=this.eventDispatchers[t];return e||(e=this.eventDispatchers[t]=y(t,this)),N(this.root,t,e),this},mt.unlistenTo=function(t){var e=this.eventDispatchers,n=this;if(0===arguments.length)return Object.keys(e).filter(function(t){var n=!!e[t];return n&&(e[t]=1),n}).forEach(function(t){n.unlistenTo(t)}),this;if(!(t in this.listenedEvents)||0===this.listenedEvents[t])return console.log('[DOMDelegator unlistenTo]event "'+t+'" is already unlistened!'),this;if(this.listenedEvents[t]--,this.listenedEvents[t]>0)return this;var r=this.eventDispatchers[t];if(!r)throw new Error("[DOMDelegator unlistenTo]: cannot unlisten to "+t);return j(this.root,t,r),this};for(var yt="undefined"!=typeof window?window:{},wt=yt.document,bt="undefined"==typeof process||process.browser?"undefined"!=typeof window?"browser":"unknown":"nodejs",Et={forcing:!1,unloaders:new p,computePreRedrawHook:null,computePostRedrawHook:null,roots:[],recreations:[],components:[],controllers:[],domCacheMap:new p,domDelegator:new m,renderQueue:new d},kt=0,xt=16,_t=["webkit","moz","ms","o"],Ot=yt.requestAnimationFrame,Nt=yt.cancelAnimationFrame||yt.cancelRequestAnimationFrame,jt=0,Tt=_t.length;Tt>jt&&!Ot;++jt)Ot=yt[_t[jt]+"RequestAnimationFrame"],Nt=yt[_t[jt]+"CancelAnimationFrame"]||yt[_t[jt]+"CancelRequestAnimationFrame"];Ot||(Ot=function(t){var e=Date.now?Date.now():(new Date).getTime(),n=Math.max(0,xt-(e-kt)),r=setTimeout(function(){t(e+n)},n);return kt=e+n,r}),Nt||(Nt=function(t){return clearTimeout(t)});var Dt={all:["altKey","bubbles","cancelable","ctrlKey","eventPhase","metaKey","relatedTarget","shiftKey","target","timeStamp","type","view","which"],mouse:["button","buttons","clientX","clientY","layerX","layerY","offsetX","offsetY","pageX","pageY","screenX","screenY","toElement"],key:["char","charCode","key","keyCode"]},Ct=/^key|input/,At=/^(?:mouse|pointer|contextmenu)|click/;T.prototype=i(T.prototype,{init:function(t){D(this,t,"all"),this.originalEvent=t,this._bubbles=!1},preventDefault:function(){return this.originalEvent.preventDefault()},startPropagation:function(){this._bubbles=!0}});var Mt,Pt=Et.domCacheMap,Rt=Et.domDelegator,Lt=Et.domDelegator,Ft=/^ev([A-Z]\w*)/,Ht=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,qt={appendChild:function(t){void 0===Mt&&(Mt=wt.createElement("html")),wt.documentElement&&wt.documentElement!==t?wt.replaceChild(t,wt.documentElement):wt.appendChild(t),this.childNodes=wt.childNodes},insertBefore:function(t){this.appendChild(t)},childNodes:[]},It=Et.domCacheMap,St=Et.renderQueue.onFinish(V),Bt=!1;Et.renderQueue.onFlush(Z).onAddTarget(z);var Wt,Ut=["componentWillMount","componentDidMount","componentWillUpdate","componentDidUpdate","componentWillUnmount","componentWillDetached","componentWillReceiveProps","getInitialProps","getInitialState"],$t=["getInitialProps","getInitialState","componentWillReceiveProps"],Kt=["setState","mixins","onunload","setInternalProps","redraw"],Yt=function(){function t(n,r){if(ft.classCallCheck(this,t),"object"!==e(n)&&null!=n)throw new TypeError("[Component]param for constructor should a object or null or undefined! given: "+n);this.props=n||{},this.props.children=l(r),this.root=null,this.getInitialProps&&(this.props=this.getInitialProps(this.props)),this.getInitialState&&(this.state=this.getInitialState(this.props))}return t.prototype.setProps=function(t,e){this.componentWillReceiveProps&&(t=this.componentWillReceiveProps(t)),this.props=s(i(this.props,t,{children:l(e)}))},t.prototype.onunload=function(t){"function"===e(t)&&t.call(this),this.root=null,this.cached=null,this.redrawData=null},t.prototype.setInternalProps=function(t,e,n){this.root=t,this.cached=e,this.redrawData=n},t.prototype.redraw=function(){if(null!=this.redrawData){var t=this;Et.renderQueue.addTarget({mergeType:0,processor:rt,root:t.root,params:[t]})}},t.prototype.setState=function(t,e){null==this.state&&(this.state={}),this.state=i(this.state,t),e||"browser"!==bt||this.redraw()},t}(),Qt=f;return Qt.render=K,Qt.redraw=X,Qt.mount=tt,Qt.component=nt,Qt.createComponent=ot,Qt.domDelegator=Et.domDelegator,"undefined"==typeof Object.assign&&(Object.assign=o),Qt});