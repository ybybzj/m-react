!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.mReact=e()}(this,function(){"use strict";function t(){}function e(t){if(null===t)return"null";if(void 0===t)return"undefined";if(t!==t)return"NaN";var e=Object.prototype.toString.call(t);switch(e){case"[object Object]":return"object";case"[object Array]":return"array";case"[object String]":return"string";case"[object Function]":return"function";case"[object Number]":return"number";case"[object RegExp]":return"regexp";default:return"unknown"}}function n(){var t=[].slice.call(arguments,1);return[].slice.apply(arguments[0],t)}function r(t){var e=function(){return arguments.length&&(t=arguments[0]),t};return e.toJSON=function(){return t},e}function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function i(){for(var t,e,n,r=arguments.length,i=0;r>i&&(n=arguments[i],n!==Object(n));)i++;if(i===r)return{};for(i++;r>i;)if(e=arguments[i++],e===Object(e))for(t in e)o(e,t)&&(n[t]=e[t]);return n}function s(){var t=n(arguments);return i.apply(null,[{}].concat(t))}function a(t){if("object"!==e(t))throw new TypeError("[removeVoidValue]param should be a object! given: "+t);var n={};return Object.keys(t).forEach(function(e){void 0!==t[e]&&(n[e]=t[e])}),n}function u(t){for(var n=[],r=!0,o=0,i=t.length;i>o;o++){var s=t[o];if("array"!==e(s)){r=!1;break}n.push(s)}return n=r===!1||0===t.length?t:[].concat.apply([],n)}function l(t){switch(e(t)){case"undefined":case"null":return[];case"array":return u(t);default:return[t]}}function c(){return Object.create(null)}function h(t,n){return"string"!==e(t)||"regexp"!==e(n)?null:t.match(n)}function d(){var t=arguments[0],r=arguments[1],o=n(arguments,2);if("string"!==e(t))throw new Error("selector in m(selector, attrs, children) should be a string");var i,s,a,u=!(null==r||"object"!==e(r)||"tag"in r||"view"in r||"subtree"in r),l={tag:"div",attrs:{}},c=[];r=u?r:{},a="class"in r?"class":"className",o=u?o:n(arguments,1),l.children="array"===e(o[0])?o[0]:o;for(;i=ft.exec(t);)""===i[1]&&i[2]?l.tag=i[2]:"#"===i[1]?l.attrs.id=i[2]:"."===i[1]?c.push(i[2]):"["===i[3][0]&&(s=pt.exec(i[3]),l.attrs[s[1]]=s[3]||(s[2]?"":!0));return c.length>0&&(l.attrs[a]=c.join(" ")),Object.keys(r).forEach(function(t){var n=r[t];l.attrs[t]=t===a&&"string"!==e(n)&&""!==n.trim()?(l.attrs[t]||"")+" "+n:n}),l}function f(){return!this instanceof f?new f:(this._index=-1,this._keys=[],void(this._values=[]))}function p(t,e){return isNaN(t)?isNaN(e):t===e}function g(t){if(t!==Object(t))throw new TypeError("[Map]Invalid value used as a map key! given: "+t)}function v(t,e,n){return t.addEventListener(e,n,!0)}function m(t,e,n){return t.removeEventListener(e,n,!0)}function y(t){return!this instanceof y?new y(t):(this.init(t),void(mt.test(t.type)?w(this,t,"key"):yt.test(t.type)&&w(this,t,"mouse")))}function w(t,e,n){for(var r=vt[n],o=0,i=r.length;i>o;o++){var s=r[o];t[s]=e[s]}}function b(t){if(!this instanceof b)return new b(t);if(t=t||Et||{documentElement:1},!t.documentElement)throw new Error('[DOMDelegator]Invalid parameter "doc", should be a document object! given: '+t);this.root=t.documentElement,this.listenedEvents=c(),this.eventDispatchers=c(),this.globalListeners=c(),this.domEvHandlerMap=new gt}function E(t,e){var n=e.globalListeners,r=e.root;return function(o){var i=n[t]||[];if(i&&i.length>0){var s=new y(o);s.target=r,O(i,s)}k(o.target,o,t,e)}}function k(t,e,n,r){var o=j(t,n,r);if(o&&o.handlers.length>0){var i=new y(e);i.currentTarget=o.currentTarget,O(o.handlers,i),i._bubbles&&k(o.currentTarget.parentNode,e,n,r)}}function j(t,e,n){if(null==t)return null;var r,o=x(n.domEvHandlerMap,t);return o&&(r=o[e])&&0!==r.length?{currentTarget:t,handlers:r}:j(t.parentNode,e,n)}function O(t,n){t.forEach(function(r){if("function"===e(r))r(n);else{if("function"!==e(r.handleEvent))throw new Error("[DOMDelegator callListeners] unknown handler found: "+JSON.stringify(t));r.handleEvent(n)}})}function x(t,e,n){return arguments.length>2?t.get(e,n):t.get(e)}function N(t,e,n,r){var o=t[e]||[];return 0===o.length&&n.listenTo(e),-1===o.indexOf(r)&&o.push(r),t[e]=o,r}function _(t,e,n,r){var o=t[e];if(!o||0===o.length||3===arguments.length)return o&&o.length&&n.unlistenTo(e),delete t[e],r;var i=o.indexOf(r);return-1!==i&&o.splice(i,1),t[e]=o,0===o.length&&(n.unlistenTo(e),delete t[e]),r}function T(t,e){return Object.keys(t).forEach(function(n){_(t,n,e)}),t}function C(n){this.options=n||{};var r=this.options.onFlush;this._cb="function"===e(r)?r:t,this._queue=[],this._startPos=0,this.flush=this.flush.bind(this)}function D(t,e){e=e||[],e=[].concat(e);for(var n=t.length-1;n>-1;n--)if(t[n]&&t[n].parentNode){e[n]&&R(e[n]),Mt.off(t[n]),Rt.remove(t[n]);try{t[n].parentNode.removeChild(t[n])}catch(r){}}0!=t.length&&(t.length=0)}function R(n){if(n.configContext&&"function"===e(n.configContext.onunload)&&(n.configContext.onunload(),n.configContext.onunload=null),n.controllers)for(var r=0,o=void 0;o=n.controllers[r];r++)"function"===e(o.onunload)&&o.onunload({preventDefault:t});if(n.children)if("array"===e(n.children))for(var r=0,i=void 0;i=n.children[r];r++)R(i);else n.children.tag&&R(n.children)}function M(t,n,r,o,i){return Object.keys(r).forEach(function(s){var a,u=r[s],l=o[s];if(s in o&&l===u)"value"===s&&"input"===n&&t.value!=u&&(t.value=u);else{o[s]=u;try{if("config"===s||"key"==s)return;if("function"===e(u)&&0===s.indexOf("on"))t[s]=u;else if((a=h(s,Pt))&&a[1].length){var c=a[1].toLowerCase();At.off(t,c),A(u)&&At.on(t,c,u)}else"style"===s&&null!=u&&"object"===e(u)?(Object.keys(u).forEach(function(e){(null==l||l[e]!==u[e])&&(t.style[e]=u[e])}),"object"===e(l)&&Object.keys(l).forEach(function(e){e in u||(t.style[e]="")})):null!=i?"href"===s?t.setAttributeNS("http://www.w3.org/1999/xlink","href",u):"className"===s?t.setAttribute("class",u):t.setAttribute(s,u):s in t&&"list"!==s&&"style"!==s&&"form"!==s&&"type"!==s&&"width"!==s&&"height"!==s?("input"!==n||t[s]!==u)&&(t[s]=u):t.setAttribute(s,u)}catch(d){if(d.message.indexOf("Invalid argument")<0)throw d}}}),o}function A(t){return"function"===e(t)||t&&"function"===e(t.handleEvent)}function P(t,n,r,o,i,s,a,u,l,c,h){try{(null==i||null==i.toString())&&(i="")}catch(d){i=""}if("retain"===i.subtree)return s;var f,p=e(s),g=e(i);return(null==s||p!==g)&&(s=q(i,s,u,o,r,g)),"array"===g?(i=I(i),f=s.length===i.length,s=L(i,s,t),s=H(i,s,t,n,u,a,f,l,c,h)):null!=i&&"object"===g?s=F(i,s,t,u,a,l,c,h):"function"!==e(i)&&(s=B(i,s,t,n,u,a,l)),s}function q(t,e,n,r,o,i){var s,a;return null!=e&&(o&&o.nodes?(s=n-r,a=s+("array"===i?t:e.nodes).length,D(o.nodes.slice(s,a),o.slice(s,a))):e.nodes&&D(e.nodes,e)),e=new t.constructor,e.tag&&(e={}),e.nodes=[],e}function L(t,n,r){function o(t){return"string"===e(t)||"number"===e(t)&&"NaN"!==e(t)}function i(t){return t&&t.attrs&&o(t.attrs.key)?t.attrs.key:void 0}function s(t,e){t&&t.attrs&&(void 0===e?delete t.attrs.key:t.attrs.key=e)}function a(t,e){return t.length!==e.length?!0:t.some(function(t,n){var r=e[n];return r.attrs&&t.attrs&&r.attrs.key!==t.attrs.key})}function u(t,e){var r=i(t);if(void 0!==r)if(f[r]){var o=f[r].index;f[r]={action:d,index:e,from:o,element:n.nodes[o]||Et.createElement("div")}}else f[r]={action:h,index:e}}function l(e){var o=e.index,i=i;if(i===c&&(D(n[o].nodes,n[o]),newCached.splice(o,1)),i===h){var s=Et.createElement("div");s.key=t[o].attrs.key,r.insertBefore(s,r.childNodes[o]||null),newCached.splice(o,0,{attrs:{key:s.key},nodes:[s]}),newCached.nodes[o]=s}i===d&&(r.childNodes[o]!==e.element&&null!==e.element&&r.insertBefore(e.element,r.childNodes[o]||null),newCached[o]=n[e.from],mewCached.nodes[o]=e.element)}var c=1,h=2,d=3,f={},p=!1;n.forEach(function(t,e){var n=i(t);s(t,n),void 0!==n&&(p=!0,f[n]={action:c,index:e})});var g=0;if(t.some(function(t){var e=i(t);return s(t,e),void 0!==e})&&t.forEach(function(t){t&&t.attrs&&null==t.attrs.key&&(t.attrs.key="__mithril__"+g++)}),p&&a(t,n)){t.forEach(u);var v=void 0,m=new Array(n.length);v=Object.keys(f).map(function(t){return f[t]}).sort(function(t,e){return t.action-e.action||t.index-e.index}),m.nodes=n.nodes.slice(),v.forEach(l),n=m}return n}function H(t,n,r,o,i,s,a,u,l,c){function h(t){var h=P(r,o,n,i,t,n[f],s,i+d||d,u,l,c);void 0!==h&&(h.nodes.intact||(a=!1),d+=h.$trusted?(h.match(/<[^\/]|\>\s*[^<]/g)||[0]).length:"array"===e(h)?h.length:1,n[f++]=h)}var d=0,f=0,p=[];if(t.forEach(h),!a){for(var g=0,v=t.length;v>g;g++)null!=n[g]&&p.push.apply(p,n[g].nodes);for(var g=0,m=void 0;m=n.nodes[g];g++)null!=m.parentNode&&p.indexOf(m)<0&&D([m],[n[g]]);t.length<n.length&&(n.length=t.length),n.nodes=p}return n}function F(n,r,o,i,s,a,u,l){for(var c,h=[],d=[];n.view;){var f=n.view.$original||n.view,p=r.views?r.views.indexOf(f):-1,g=p>-1?r.controllers[p]:new(n.controller||t);c=g.name;var v=n&&n.attrs&&n.attrs.key;if(n=0==jt.pendingRequests||jt.forcing||r&&r.controllers&&r.controllers.indexOf(g)>-1?n.view(g):{tag:"placeholder"},"retain"===n.subtree)return r;null!=v&&(n.attrs||(n.attrs={}),n.attrs.key=v),g.onunload&&jt.unloaders.push({controller:g,handler:g.onunload}),h.push(f),d.push(g)}if(!n.tag&&d.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");if(n.attrs||(n.attrs={}),r.attrs||(r.attrs={}),(n.tag!=r.tag||!$(n.attrs,r.attrs)||n.attrs.id!=r.attrs.id||n.attrs.key!=r.attrs.key||"string"===e(c)&&r.componentName!=c)&&r.nodes.length&&D(r.nodes,r),"string"===e(n.tag)){var m,y,w=0===r.nodes.length,b=Object.keys(n.attrs),E=b.length>("key"in n.attrs?1:0);if(n.attrs.xmlns?u=n.attrs.xmlns:"svg"===n.tag?u="http://www.w3.org/2000/svg":"math"===n.tag&&(u="http://www.w3.org/1998/Math/MathML"),w){var k=S(o,u,n,i);if(m=k[0],y=k[1],r={tag:n.tag,attrs:E?M(m,n.tag,n.attrs,{},u):n.attrs,children:null!=n.children&&n.children.length>0?P(m,n.tag,void 0,void 0,n.children,r.children,!0,0,n.attrs.contenteditable?m:a,u,l):n.children,nodes:[m]},d.length){r.views=h,r.controllers=d;for(var j=0,g=void 0;g=d[j];j++)if(g.onunload&&g.onunload.$old&&(g.onunload=g.onunload.$old),jt.pendingRequests&&g.onunload){var O=g.onunload;g.onunload=t,g.onunload.$old=O}}r.children&&!r.children.nodes&&(r.children.nodes=[]),"select"===n.tag&&"value"in n.attrs&&M(m,n.tag,{value:n.attrs.value},{},u),null!=y&&o.insertBefore(m,o.childNodes[y]||null)}else m=r.nodes[0],E&&M(m,n.tag,n.attrs,r.attrs,u),r.children=P(m,n.tag,void 0,void 0,n.children,r.children,!1,0,n.attrs.contenteditable?m:a,u,l),r.nodes.intact=!0,d.length&&(r.views=h,r.controllers=d),s===!0&&null!=m&&o.insertBefore(m,o.childNodes[i]||null);if("function"===e(n.attrs.config)){var x=r.configContext=r.configContext||{},N=function(t,e){return function(){return t.attrs.config.apply(t,e)}};l.push(N(n,[m,!w,x,r]))}return"string"===e(c)&&(r.componentName=c),r}}function S(t,e,n,r){var o,i,s=r;if(t&&t.childNodes.length&&(i=W(t,r),i&&i[0])){if(s=i[1],i[0].tagName.toLowerCase()==n.tag.toLowerCase())return[i[0],null];D([i[0]])}return o=n.attrs.is?void 0===e?Et.createElement(n.tag,n.attrs.is):Et.createElementNS(e,n.tag,n.attrs.is):void 0===e?Et.createElement(n.tag):Et.createElementNS(e,n.tag),o.setAttribute("data-mref",r),[o,s]}function W(t,e){for(var n,r=0,o=t.childNodes.length;o>r;r++)if(n=t.childNodes[r],n.getAttribute&&n.getAttribute("data-mref")==e)return[n,r];return null}function B(t,e,n,r,o,i,s){var a;if(0===e.nodes.length){if(""==t)return e;D([n.childNodes[o]]),t.$trusted?a=U(n,o,t):(a=[Et.createTextNode(t)],n.nodeName.match(qt)||n.insertBefore(a[0],n.childNodes[o]||null)),e="string number boolean".indexOf(typeof t)>-1?new t.constructor(t):t,e.nodes=a}else e.valueOf()!==t.valueOf()||i===!0?(a=e.nodes,s&&s===Et.activeElement||(t.$trusted?(D(a,e),a=U(n,o,t)):"textarea"===r?n.value=t:s?s.innerHTML=t:((1===a[0].nodeType||a.length>1)&&(D(e.nodes,e),a=[Et.createTextNode(t)]),n.insertBefore(a[0],n.childNodes[o]||null),a[0].nodeValue=t)),e=new t.constructor(t),e.nodes=a):e.nodes.intact=!0;return e}function I(t){for(var n=0;n<t.length;n++)"array"===e(t[n])&&(t=t.concat.apply([],t),n--);return t}function $(t,e){var n=Object.keys(t).sort().join(),r=Object.keys(e).sort().join();return n===r}function U(t,e,n){var r=t.childNodes[e];if(r){var o=1!==r.nodeType,i=Et.createElement("span");o?(t.insertBefore(i,r||null),i.insertAdjacentHTML("beforebegin",n),t.removeChild(i)):r.insertAdjacentHTML("beforebegin",n)}else t.insertAdjacentHTML("beforeend",n);for(var s,a=[];(s=t.childNodes[e++])!==r;)a.push(s);return a}function K(t,e,n,r){var o={root:t,vNode:e,forceRecreation:n};return r===!0?Y(o):void jt.renderQueue.addTarget(o)}function Y(t){var e=t.root,n=t.vNode,r=t.forceRecreation;if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var o,i=[],s=e===Et,a=s||e===Et.documentElement?Ht:e;s&&"html"!==n.tag&&(n={tag:"html",attrs:{},children:n}),r&&G(a),o=P(a,null,void 0,void 0,n,Ft.get(a),!1,0,null,void 0,i),i.forEach(function(t){t()}),Ft.set(a,o)}function X(t,e){var n,r,o=-1;for(n=0,r=t.length;r>n;n++)if(t[n].root===e.root){o=n;break}return o>-1&&t.splice(o,1),t.push(e),t}function G(t){D(t.childNodes,Ft.get(t)),Ft.remove(t)}function Q(t){Bt!==!0&&(Bt=!0,t===!0&&(jt.forcing=!0),V(t),Bt=!1)}function V(t){var n,r,o,i;(0===Wt.length()||t===!0)&&"function"===e(jt.computePreRedrawHook)&&(jt.computePreRedrawHook(),jt.computePreRedrawHook=null),Wt.length()>0&&Wt.stop();for(var s=0,a=jt.roots.length;a>s;s++){if(n=jt.roots[s],r=jt.components[s],o=jt.controllers[s],i=jt.recreations[s],o){var u=r.controller&&r.controller.$$args?[o].concat(r.controller.$$args):[o];t!==!0?K(n,r.view?r.view.apply(r,u):"",i):K(n,r.view?r.view.apply(r,u):"",i,!0)}jt.recreations[s]=void 0}t===!0&&(J(),jt.forcing=!1)}function J(){"function"===e(jt.computePostRedrawHook)&&(jt.computePostRedrawHook(),jt.computePostRedrawHook=null)}function Z(){jt.pendingRequests++}function z(){jt.pendingRequests=Math.max(jt.pendingRequests-1,0),0===jt.pendingRequests&&St()}function tt(e,r){var o=function(){return(e.controller||t).apply(this,r)||this},i=function(t){return arguments.length>1&&(r=r.concat(n(arguments,1))),e.view.apply(e,r.length?[t].concat(r):[t])};i.$original=e.view;var s={controller:o,view:i};return r[0]&&null!=r[0].key&&(s.attrs={key:r[0].key}),s}function et(t){return tt(t,n(arguments,1))}function nt(n,r,o){if(!n)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var i=jt.roots.indexOf(n);0>i&&(i=jt.roots.length);for(var s=!1,a={preventDefault:function(){s=!0,jt.computePreRedrawHook=jt.computePostRedrawHook=null}},u=0,l=void 0;l=jt.unloaders[u];u++)l.handler.call(l.controller,a),l.controller.onunload=null;if(s)for(var u=0,l=void 0;l=jt.unloaders[u];u++)l.controller.onunload=l.handler;else jt.unloaders=[];if(jt.controllers[i]&&"function"===e(jt.controllers[i].onunload)&&jt.controllers[i].onunload(a),!s){Z(),jt.roots[i]=n;var c=$t=r=r||{controller:t},h=r.controller||t,d=new h;return c===$t&&(jt.controllers[i]=d,jt.components[i]=r,jt.recreations[i]=o),z(),jt.controllers[i]}}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t){if("object"!==e(t))throw new TypeError("[createComponent]param should be a object! given: "+t);var n={},r=st(t);return n.controller=function(t,n){var o=new r(t,n),i={instance:o};return"function"===e(o.componentWillUnmount)&&(i.onunload=o.onunload.bind(o,o.componentWillUnmount)),"string"===e(o.name)&&(i.name=o.name),i},n.view=at(),n}function it(t,r){var o;for("array"!==e(r)&&(r=n(arguments,1)),r=r.filter(function(t){return"object"===e(t)});r.length>0;)o=r.shift(),Object.keys(o).forEach(function(n){if("mixins"===n)return void(r=ct([].concat(o[n]),r));if(-1===Xt.indexOf(n))return-1!==Kt.indexOf(n)?void("array"===e(t[n])?t[n].push(o[n]):t[n]="function"===e(t[n])?[t[n],o[n]]:[o[n]]):void(t[n]=o[n])});Kt.forEach(function(n){if("array"===e(t[n])){var r=t[n].filter(function(t){return"function"===e(t)});t[n]=ht(-1!==Yt.indexOf(n),r)}})}function st(t){var n,r=function(){Gt.apply(this,arguments),ut(r.prototype,this)};return r.prototype=Object.create(Gt.prototype),n=t.mixins||[],delete t.mixins,n="array"===e(n)?n.concat(t):[n,t],it(r.prototype,n),r}function at(){var t={};return function(n,r,o){var i=n.instance,s=t.props,a=t.state,u=function(t,n,r){lt(i,"setRoot",t),n?lt(i,"componentDidUpdate",t,s,a):(lt(i,"componentDidMount",t),"function"===e(i.componentWillDetached)&&(r.onunload=i.componentWillDetached.bind(i,t)))};if(i.setProps(r,o),t.props=i.props,t.state=i.state,null!=i.root){if(lt(i,"shouldComponentUpdate",s,a)===!1)return{subtree:"retain"};lt(i,"componentWillUpdate",i.root,s,a)}else lt(i,"componentWillMount",s,a);var l=lt(i,"render",i.props,i.state);return l.attrs=l.attrs||{},l.attrs.config=u,l}}function ut(t,n){Object.keys(t).forEach(function(r){var o=t[r];("function"===e(o)||/^on[A-Z]\w*/.test(r))&&(n[r]=o.bind(n))})}function lt(t,r){var o=n(arguments,2);return"function"===e(t[r])?t[r].apply(t,o):void 0}function ct(t,e){var n,r,o=t.length;for(n=0;o>n;n++)r=t[n],-1===e.indexOf(r)&&e.unshift(r);return e}function ht(t,e){return function(){for(var r,o=n(arguments,0),i=this,s=0,a=e.length,u=o;a>s;s++)r=e[s],u=r.apply(i,o),o=t?u:o;return u}}var dt=d,ft=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,pt=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/;d.trust=function(t){return t=new String(t),t.$trusted=!0,t};var gt=f;f.prototype={has:function(t){g(t);var e,n=this._keys;if(t!=t||0===t)for(e=n.length;e--&&!p(n[e],t););else e=n.indexOf(t);return this._index=e,e>-1},clear:function(){this._keys.length=0,this._values.length=0,this._index=-1},set:function(t,e){return this.has(t)?this._values[this._index]=e:this._values[this._keys.push(t)-1]=e,this},get:function(t,e){return this.has(t)?this._values[this._index]:(arguments.length>1&&this.set(t,e),e)},remove:function(t){var e=this._index;return this.has(t)&&(this._keys.splice(e,1),this._values.splice(e,1)),e>-1}};var vt={all:["altKey","bubbles","cancelable","ctrlKey","eventPhase","metaKey","relatedTarget","shiftKey","target","timeStamp","type","view","which"],mouse:["button","buttons","clientX","clientY","layerX","layerY","offsetX","offsetY","pageX","pageY","screenX","screenY","toElement"],key:["char","charCode","key","keyCode"]},mt=/^key|input/,yt=/^(?:mouse|pointer|contextmenu)|click/;y.prototype=s(y.prototype,{init:function(t){w(this,t,"all"),this.originalEvent=t,this._bubbles=!1},preventDefault:function(){return this.originalEvent.preventDefault()},startPropagation:function(){this._bubbles=!0}});var wt=b.prototype;wt.on=function(t,e,n){var r=x(this.domEvHandlerMap,t,c());return N(r,e,this,n),this},wt.off=function(t,e,n){var r=x(this.domEvHandlerMap,t);return r?(arguments.length>=3?_(r,e,this,n):2===arguments.length?_(r,e,this):T(r,this),0===Object.keys(r).length&&this.domEvHandlerMap.remove(t),this):this},wt.addGlobalEventListener=function(t,e){return N(this.globalListeners,t,this,e),this},wt.removeGlobalEventListener=function(t,e){return arguments.length>=2?_(this.globalListeners,t,this,e):1===arguments.length?_(this.globalListeners,t,this):T(this.globalListeners,this),this},wt.destroy=function(){this.unlistenTo(),this.listenedEvents=null,this.eventDispatchers=null,this.globalListeners=null,this.domEvHandlerMap.clear()},wt.listenTo=function(t){if(t in this.listenedEvents||(this.listenedEvents[t]=0),this.listenedEvents[t]++,1===this.listenedEvents[t]){var e=this.eventDispatchers[t];return e||(e=this.eventDispatchers[t]=E(t,this)),v(this.root,t,e),this}},wt.unlistenTo=function(t){var e=this.eventDispatchers,n=this;if(0===arguments.length)return Object.keys(e).filter(function(t){var n=!!e[t];return n&&(e[t]=1),n}).forEach(function(t){n.unlistenTo(t)}),this;if(!(t in this.listenedEvents)||0===this.listenedEvents[t])return void console.log('[DOMDelegator unlistenTo]event "'+t+'" is already unlistened!');if(this.listenedEvents[t]--,!(this.listenedEvents[t]>0)){var r=this.eventDispatchers[t];if(!r)throw new Error("[DOMDelegator unlistenTo]: cannot unlisten to "+t);return m(this.root,t,r),this}},C.prototype.addTarget=function(t){var n=this._queue.length;return"function"===e(this.options.onAddTarget)?this._queue=this.options.onAddTarget.call(this,this._queue,t):this._queue.push(t),0===n&&1===this._queue.length&&this.scheduleFlush(),this},C.prototype.removeTarget=function(t){var e=this._queue.indexOf(t);return-1!==e&&this._queue.splice(e,1),this},C.prototype.flush=function(){var t,n,r,o,i,s=new Date,a=this._cb,u=this._startPos;for(i=this._queue,r=u,o=i.length;o>r;r++)if(n=i[r],a.call(null,n),t=new Date-s,t>xt){console.log("frame budget overflow:",t),r++;break}this._queue.splice(0,r),this._startPos=0,this._queue.length?this.scheduleFlush():"function"===e(this.options.onFinish)&&this.options.onFinish.call(null)},C.prototype.scheduleFlush=function(){return this._tick=_t(this.flush),this._tick},C.prototype.onFlush=function(t){if("function"!==e(t))throw new TypeError("[Batch.prototype.onFlush]need a Function here, but given "+t);return this._cb=t,this},C.prototype.length=function(){return this._queue.length},C.prototype.stop=function(){return Tt(this._tick),this._queue.length=0,this},["onAddTarget","onFinish"].forEach(function(t){C.prototype[t]=function(n){if("function"!==e(n))throw new TypeError("[Batch.prototype."+t+"]need a Function here, but given "+n);return this.options[t]=n,this}});for(var bt="undefined"!=typeof window?window:{},Et=bt.document,kt="undefined"==typeof process||process.browser?"undefined"!=typeof window?"browser":"unknown":"nodejs",jt={pendingRequests:0,forcing:!1,unloaders:[],updateStrategy:r("diff"),computePreRedrawHook:null,computePostRedrawHook:null,roots:[],recreations:[],components:[],controllers:[],domCacheMap:new gt,domDelegator:new b,renderQueue:new C},Ot=0,xt=16,Nt=["webkit","moz","ms","o"],_t=bt.requestAnimationFrame,Tt=bt.cancelAnimationFrame||bt.cancelRequestAnimationFrame,Ct=0,Dt=Nt.length;Dt>Ct&&!_t;++Ct)_t=bt[Nt[Ct]+"RequestAnimationFrame"],Tt=bt[Nt[Ct]+"CancelAnimationFrame"]||bt[Nt[Ct]+"CancelRequestAnimationFrame"];_t||(_t=function(t){var e=Date.now?Date.now():(new Date).getTime(),n=Math.max(0,xt-(e-Ot)),r=setTimeout(function(){t(e+n)},n);return Ot=e+n,r}),Tt||(Tt=function(t){return clearTimeout(t)});var Rt=jt.domCacheMap,Mt=jt.domDelegator,At=jt.domDelegator,Pt=/^ev([A-Z]\w*)/,qt=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/;jt.renderQueue.onFlush(Y).onAddTarget(X);var Lt,Ht={appendChild:function(t){void 0===Lt&&(Lt=Et.createElement("html")),Et.documentElement&&Et.documentElement!==t?Et.replaceChild(t,Et.documentElement):Et.appendChild(t),this.childNodes=Et.childNodes},insertBefore:function(t){this.appendChild(t)},childNodes:[]},Ft=jt.domCacheMap,St=Q,Wt=jt.renderQueue.onFinish(J),Bt=!1,It={get redraw(){return St},get startComputation(){return Z},get endComputation(){return z}};St.strategy=jt.updateStrategy;var $t,Ut=et,Kt=["componentWillMount","componentDidMount","componentWillUpdate","componentDidUpdate","componentWillUnmount","componentWillDetached","componentWillReceiveProps","getInitialProps","getInitialState"],Yt=["getInitialProps","getInitialState","componentWillReceiveProps"],Xt=["setState","mixins","onunload","setRoot"],Gt=function(){function t(n,r){if(rt(this,t),"object"!==e(n)&&null!=n)throw new TypeError("[Component]param for constructor should a object or null or undefined! given: "+n);this.props=n||{},this.state={},this.props.children=l(r),this.root=null,this.getInitialProps&&(this.props=this.getInitialProps(this.props)),this.getInitialState&&(this.state=this.getInitialState(this.props))}return t.prototype.setProps=function(t,e){this.componentWillReceiveProps&&(t=this.componentWillReceiveProps(t)),this.props=a(s(this.props,t,{children:l(e)}))},t.prototype.onunload=function(t){"function"===e(t)&&t.call(this),this.root=null},t.prototype.setRoot=function(t){this.root=t},t.prototype.setState=function(t,e){e||"browser"!==kt||It.startComputation(),this.state=s(this.state,t),e||"browser"!==kt||It.endComputation()},t}(),Qt=dt;Qt.render=K,Qt.redraw=St,Qt.mount=nt,Qt.component=Ut,Qt.createComponent=ot,Qt.domDelegator=jt.domDelegator,"undefined"==typeof Object.assign&&(Object.assign=i);var Vt=Qt;return Vt});